<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A more verbose getting started with Herb.jl · Herb.jl</title><meta name="title" content="A more verbose getting started with Herb.jl · Herb.jl"/><meta property="og:title" content="A more verbose getting started with Herb.jl · Herb.jl"/><meta property="twitter:title" content="A more verbose getting started with Herb.jl · Herb.jl"/><meta name="description" content="Documentation for Herb.jl."/><meta property="og:description" content="Documentation for Herb.jl."/><meta property="twitter:description" content="Documentation for Herb.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Herb.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../">Herb.jl</a></li><li><a class="tocitem" href="../../install/">Installation Guide</a></li><li><a class="tocitem" href="../basic_getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../concepts/">Herb Architecture and Core Concepts</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>A more verbose getting started with Herb.jl</a></li><li><a class="tocitem" href="../defining_grammars/">Defining Grammars in Herb.jl</a></li><li><a class="tocitem" href="../advanced_search/">Advanced Search Procedures</a></li><li><a class="tocitem" href="../TopDown/">Top Down Iterator</a></li><li><a class="tocitem" href="../getting_started_with_constraints/">Getting started with Constraints</a></li><li><a class="tocitem" href="../working_with_interpreters/">Working with custom interpreters</a></li><li><a class="tocitem" href="../abstract_syntax_trees/">Abstract Syntax Trees</a></li></ul></li><li><span class="tocitem">Sub-Modules</span><ul><li><a class="tocitem" href="../../HerbCore/">HerbCore.jl</a></li><li><a class="tocitem" href="../../HerbGrammar/">HerbGrammar.jl</a></li><li><a class="tocitem" href="../../HerbSpecification/">HerbSpecification.jl</a></li><li><a class="tocitem" href="../../HerbInterpret/">HerbInterpret.jl</a></li><li><a class="tocitem" href="../../HerbConstraints/">HerbConstraints.jl</a></li><li><a class="tocitem" href="../../HerbSearch/">HerbSearch.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>A more verbose getting started with Herb.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A more verbose getting started with Herb.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Herb-AI/Herb.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Herb-AI/Herb.jl/blob/main/docs/src/tutorials/getting_started_with_herb.jl" title="View source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><style>
    #documenter-page table {
        display: table !important;
        margin: 2rem auto !important;
        border-top: 2pt solid rgba(0,0,0,0.2);
        border-bottom: 2pt solid rgba(0,0,0,0.2);
    }

    #documenter-page pre, #documenter-page div {
        margin-top: 1.4rem !important;
        margin-bottom: 1.4rem !important;
    }

    .code-output {
        padding: 0.7rem 0.5rem !important;
    }

    .admonition-body {
        padding: 0em 1.25em !important;
    }
</style>

<!-- PlutoStaticHTML.Begin -->
<!--
    # This information is used for caching.
    [PlutoStaticHTML.State]
    input_sha = "23f1b9e657e98a182aa3a400472634ac1e30abf3e8b119d102426e9fa1d43ffb"
    julia_version = "1.11.3"
-->

<div class="markdown"><h1>Search</h1><p>This notebook describes how you can search a program space as defined by a grammar. Specifically, we will look at example-based search, where the goal is to find a program that is able to transform the inputs of every example to the corresponding output.</p></div>


<div class="markdown"><h3>Setup</h3><p>First, we start with the setup. We need access to all the function in the Herb.jl framework.</p></div>

<pre class='language-julia'><code class='language-julia'>using Herb</code></pre>



<div class="markdown"><h3>Defining the program space</h3><p>Next, we start by creating a grammar. We define a context-free grammar as a <a href="@ref"><code>HerbGrammar.ContextSpecificGrammar</code></a> without any constraints. A context-free grammar is just a simple set of production rules for defining combinations of terminal symbols (in our case integers). </p><p>Alternatively we could define a context-sensitive grammar, when the production rules only hold in a certain context. For more information on this, please see our tutorial on <a href="defining_grammars.md">defining grammars</a>.</p><p>For now, we specify a simple grammar (using the <code>@csgrammar</code> macro) for dealing with integers and explain all the rules individually:</p><ol><li><p>First, we specify our number values and constrain them to being positive even integers.</p></li><li><p>Then, we can also use the variable <code>x</code> to hold an integer.</p></li><li><p>The third rule determines we can add two integers.</p></li><li><p>The fourth rule determines we can subtract an integer from another.</p></li><li><p>Finally, we also allow the multiplication of two integers.</p></li></ol><p>If you run this cell, you can see all the rules rolled out.</p></div>

<pre class='language-julia'><code class='language-julia'>g = HerbGrammar.@csgrammar begin
    Number = 0|2|4|6|8
    Number = x
    Number = Number + Number
    Number = Number - Number
    Number = Number * Number
end</code></pre>
<pre class="code-output documenter-example-output" id="var-g">1: Number = 0
2: Number = 2
3: Number = 4
4: Number = 6
5: Number = 8
6: Number = x
7: Number = Number + Number
8: Number = Number - Number
9: Number = Number * Number
</pre>


<div class="markdown"><h3>Defining the problem</h3></div>


<div class="markdown"><p>As mentioned before, we are looking at example-based search.  This means that the problem is defined by a set of input-output examples.  A single example hence consists of an input and an output. The input is defined as a dictionary, with a value assigned to each variable in the grammar. It is important to write the variable name as a <code>Symbol</code> instead of a string. A <code>Symbol</code> in Julia is written with a colon prefix, i.e. <code>:x</code>.  The output of the input-output example is just a single value for this specific grammar, but could possibly relate to e.g. arrays of values, too.</p><p>In the cell below we automatically generate some examples for <code>x</code> assigning values <code>1-5</code>.</p></div>

<pre class='language-julia'><code class='language-julia'># Create input-output examples
examples = [HerbSpecification.IOExample(Dict(:x =&gt; x), 4x + 6) for x ∈ 1:5]</code></pre>
<pre class="code-output documenter-example-output" id="var-examples">5-element Vector{IOExample{Int64, Int64}}:
 IOExample{Int64, Int64}(Dict(:x =&gt; 1), 10)
 IOExample{Int64, Int64}(Dict(:x =&gt; 2), 14)
 IOExample{Int64, Int64}(Dict(:x =&gt; 3), 18)
 IOExample{Int64, Int64}(Dict(:x =&gt; 4), 22)
 IOExample{Int64, Int64}(Dict(:x =&gt; 5), 26)</pre>


<div class="markdown"><p>Now that we have some input-output examples, we can define the problem.  Next to the examples, a problem also contains a name meant to link to the file path, which can be used to keep track of current examples.  For now, this is irrelevant, and you can give the program any name you like.</p></div>

<pre class='language-julia'><code class='language-julia'>problem_1 = HerbSpecification.Problem("example", examples)</code></pre>
<pre class="code-output documenter-example-output" id="var-problem_1">Problem{Vector{IOExample{Int64, Int64}}}("example", IOExample{Int64, Int64}[IOExample{Int64, Int64}(Dict(:x =&gt; 1), 10), IOExample{Int64, Int64}(Dict(:x =&gt; 2), 14), IOExample{Int64, Int64}(Dict(:x =&gt; 3), 18), IOExample{Int64, Int64}(Dict(:x =&gt; 4), 22), IOExample{Int64, Int64}(Dict(:x =&gt; 5), 26)])</pre>


<div class="markdown"><h3>Searching</h3><p>Now that we have defined the search space and the goal of the search, we can start the search. </p><p>Of course, our problem is underdefined as there might be multiple programs that satisfy our examples.  Let us consider the case where we also have a ternary if-then-else operator and standard boolean operators in our grammar: we could synthesize the program <code>x ≤ 5 ? 3x+5 : 0</code>.  This program satisfies all our examples, but we don't expect it to generalize very well.</p><p>To search through a program space, we first need to define a <a href="@ref"><code>HerbSearch.ProgramIterator</code></a>, which can be instantiated with different iterators, for now we use a simple <a href="@ref"><code>HerbSearch.BFSIterator</code></a>. For more advanced search methods check out our tutorial on <a href=".advanced_search.md">advanced search</a>. For more information about iterators, check out our tutorial on <a href=".working_with_interpreters.md">working with interpreters</a>. </p><p>In general, we assume that a smaller program is more general than a larger program.  Therefore, we search for the smallest program in our grammar that satisfies our examples.  This can be done using a breadth-first search over the program/search space.</p><p>This search is very basic; it makes use of an enumeration technique, where we enumerate programs one-by-one until we find a program that matches our examples. The search procedure has a built-in default evaluator to verify the candidate programs with the given input. The search procedure also has a built-in search procedure using breadth-first search. </p><p>So, we only need to give our grammar and the problem to our search procedure, along with a starting <code>Symbol</code>, in our case a <code>Number</code>. </p></div>

<pre class='language-julia'><code class='language-julia'>iterator_1 = BFSIterator(g, :Number)</code></pre>
<pre class="code-output documenter-example-output" id="var-iterator_1">BFSIterator(GenericSolver(1: Number = 0
2: Number = 2
3: Number = 4
4: Number = 6
5: Number = 8
6: Number = x
7: Number = Number + Number
8: Number = Number - Number
9: Number = Number * Number
, SolverState(hole[Bool[1, 1, 1, 1, 1, 1, 1, 1, 1]], Set{AbstractLocalConstraint}(), true), DataStructures.PriorityQueue{AbstractLocalConstraint, Int64, Base.Order.ForwardOrdering}(), nothing, false, 9223372036854775807, 9223372036854775807))</pre>

<pre class='language-julia'><code class='language-julia'>synth(problem_1, iterator_1)</code></pre>
<pre class="code-output documenter-example-output" id="var-hash471578">(7{9{6,3},4}, optimal_program)</pre>


<div class="markdown"><p>As you can see, the search procedure found the correct program!</p></div>


<div class="markdown"><h3>Defining the search procedure</h3><p>In the previous case, we used the built-ins of the search procedure. However, we can also give a custom enumerator to the search procedure and define a few more values.</p><p>We first define a new problem to test with, we are looking for the programs that can compute the value <code>168</code>. We immediately pass the examples to the problem and then set up the new search.</p><p>Search is done by passing the grammar, the problem and the starting point like before. We now also specify the enumeration function to be used, and now we use depth-first search. Then, we give the maximum depth of the programs we want to search for <code>(3)</code>, the maximum number of nodes in the Abstract Syntax Tree that exists during search <code>(10)</code>, and the maximum time in seconds allowed for the search.</p></div>

<pre class='language-julia'><code class='language-julia'>begin
    problem_2 = HerbSpecification.Problem("example2", [HerbSpecification.IOExample(Dict(:x =&gt; x), 168) for x ∈ 1:5])
    iterator_2 = HerbSearch.BFSIterator(g, :Number, max_depth=4, max_size=30)
    expr_2, flag_2 = HerbSearch.synth(problem_2, iterator_2)
    println(expr_2)
    program_2 = rulenode2expr(expr_2, g)
    println(program_2)
end</code></pre>



<div class="markdown"><p>We see that our synthesizer can find a program to construct the value <code>168</code>, though a fun experiment would be trying to get the value <code>167</code>, what do you think would happen? You can try below, using the same iterator.</p><p>In any case, this concludes our first introduction to the <code>Herb.jl</code> program synthesis framework. You can see more examples in this repository, or explore yourself. Enjoy!</p></div>

<pre class='language-julia'><code class='language-julia'>begin
    problem_3 = HerbSpecification.Problem("example3", [HerbSpecification.IOExample(Dict(:x =&gt; x), 167) for x ∈ 1:5])
    expr_3, flag_3 = HerbSearch.synth(problem_3, iterator_2)
    println(expr_3)
    program_3 = rulenode2expr(expr_3, g)
    println(program_3)
end</code></pre>


<!-- PlutoStaticHTML.End --><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../concepts/">« Herb Architecture and Core Concepts</a><a class="docs-footer-nextpage" href="../defining_grammars/">Defining Grammars in Herb.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 25 February 2025 13:17">Tuesday 25 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
