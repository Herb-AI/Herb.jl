<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>An more verbose getting started with Herb.jl · Herb.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Herb.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Herb.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../">Herb.jl</a></li><li><a class="tocitem" href="../../install/">Installation Guide</a></li><li><a class="tocitem" href="../../get_started/">Getting Started</a></li><li><a class="tocitem" href="../../concepts/">Architecture and core concepts</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>An more verbose getting started with Herb.jl</a></li><li><a class="tocitem" href="../defining_grammars/">Defining Grammars in Herb.jl</a></li></ul></li><li><span class="tocitem">Sub-Modules</span><ul><li><a class="tocitem" href="../../HerbGrammar/">HerbGrammar.jl</a></li><li><a class="tocitem" href="../../HerbSearch/">HerbSearch.jl</a></li><li><a class="tocitem" href="../../HerbConstraints/">HerbConstraints.jl</a></li><li><a class="tocitem" href="../../HerbData/">HerbCore.jl</a></li><li><a class="tocitem" href="../../HerbInterpret/">HerbInterpret.jl</a></li><li><a class="tocitem" href="../../HerbData/">HerbData.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>An more verbose getting started with Herb.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>An more verbose getting started with Herb.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Herb-AI/Herb.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Search"><a class="docs-heading-anchor" href="#Search">Search</a><a id="Search-1"></a><a class="docs-heading-anchor-permalink" href="#Search" title="Permalink"></a></h1><p>This notebook describes how you can search a program space as defined by a grammar. Specifically, we will look at example-based search, where the goal is to find a program that is able to transform the inputs of every example to the corresponding output.</p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>First, we start with the setup. We need to access to all the function in the Herb.jl framework.</p><pre><code class="language-julia hljs">using Herb</code></pre><h3 id="Defining-the-program-space"><a class="docs-heading-anchor" href="#Defining-the-program-space">Defining the program space</a><a id="Defining-the-program-space-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-program-space" title="Permalink"></a></h3><p>Next, we start by creating a grammar. We define a context-free grammar which is just a simple set of production rules for defining combinations of terminal symbols (in our case real numbers). </p><p>Contrary, we could define a context-sensitive grammar, when the production rules only hold in a certain context. However, for more information on this, please see <code>example2_defining_grammars.ipynb</code>.</p><p>For now, we specify a simple grammar for dealing with integers and explain all the rules individually:</p><ol><li>First, we specify our interval <code>[0:9]</code> on real numbers and also constrain them to be integer.</li><li>Then, we can also use the variable <code>x</code> to hold an integer.</li><li>The third rule determines we can add two integers.</li><li>The fourth rule determines we can subtract an integer from another.</li><li>Finally, we also allow the multiplication of two integers.</li></ol><p>If you run this cell, you can see all the rules rolled out.</p><pre><code class="language-julia hljs">g = Herb.HerbGrammar.@cfgrammar begin
    Real = |(0:9)
    Real = x
    Real = Real + Real
    Real = Real - Real
    Real = Real * Real
end</code></pre><pre><code class="nohighlight hljs">1: Real = 0
2: Real = 1
3: Real = 2
4: Real = 3
5: Real = 4
6: Real = 5
7: Real = 6
8: Real = 7
9: Real = 8
10: Real = 9
11: Real = x
12: Real = Real + Real
13: Real = Real - Real
14: Real = Real * Real</code></pre><h3 id="Defining-the-problem"><a class="docs-heading-anchor" href="#Defining-the-problem">Defining the problem</a><a id="Defining-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-problem" title="Permalink"></a></h3><p>As mentioned before, we are looking at example-based search.  This means that the problem is defined by a set of input-output examples.  A single example hence consists of an input and an output. The input is defined as a dictionary, with a value assigned to each variable in the grammar. It is important to write the variable name as a <code>Symbol</code> instead of a string. A <code>Symbol</code> in Julia is written with a colon prefix, i.e. <code>:x</code>.  The output of the input-output example is just a single value for this specific grammar, but could possibly relate to e.g. arrays of values, too.</p><p>In the cell below we automatically generate some examples for <code>x</code> assigning values <code>1-5</code>.</p><pre><code class="language-julia hljs"># Create input-output examples
examples = [Herb.HerbData.IOExample(Dict(:x =&gt; x), 3x+5) for x ∈ 1:5]</code></pre><pre><code class="nohighlight hljs">5-element Vector{Main.Herb.HerbData.IOExample}:
 Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 1), 8)
 Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 2), 11)
 Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 3), 14)
 Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 4), 17)
 Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 5), 20)</code></pre><p>Now that we have some input-output examples, we can define the problem.  Next to the examples, a problem also contains a name meant to link to the file path, which can be used to keep track of current examples.  For now, this is irrelevant, and you can give the program any name you like.</p><pre><code class="language-julia hljs">problem = Herb.HerbData.Problem(examples, &quot;example&quot;)</code></pre><pre><code class="nohighlight hljs">Main.Herb.HerbData.Problem(Main.Herb.HerbData.Example[Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 1), 8), Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 2), 11), Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 3), 14), Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 4), 17), Main.Herb.HerbData.IOExample(Dict{Symbol, Any}(:x =&gt; 5), 20)], &quot;example&quot;)</code></pre><h3 id="Searching"><a class="docs-heading-anchor" href="#Searching">Searching</a><a id="Searching-1"></a><a class="docs-heading-anchor-permalink" href="#Searching" title="Permalink"></a></h3><p>Now that we have defined the search space and the goal of the search, we can start the search. </p><p>Of course, our problem is underdefined as there might be multiple programs that satisfy our examples.  Let us consider the case where we also have a ternary if-then-else operator and standard boolean operators in our grammar: we could synthesize the program <code>x ≤ 5 ? 3x+5 : 0</code>.  This program satisfies all our examples, but we don&#39;t expect it to generalize very well.</p><p>In general, we assume that a smaller program is more general than a larger program.  Therefore, we search for the smallest program in our grammar that satisfies our examples.  This can be done using a breadth-first search over the program/search space.</p><p>This search is very basic; it makes use of an enumeration technique, where we enumerate programs one-by-one until we find a program that matches our examples. The search procedure has a built-in default evaluator to verify the candidate programs with the given input. The search procedure also has a built-in search procedure using breadth-first search. </p><p>So, we only need to give our grammar and the problem to our search procedure, along with a starting <code>Symbol</code>, in our case a <code>Real</code>.</p><pre><code class="language-julia hljs">Herb.HerbSearch.search(g, problem, :Real)</code></pre><pre><code class="nohighlight hljs">:(x * 3 + 5)</code></pre><p>As you can see, the search procedure found the correct program!</p><h3 id="Defining-the-search-procedure"><a class="docs-heading-anchor" href="#Defining-the-search-procedure">Defining the search procedure</a><a id="Defining-the-search-procedure-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-search-procedure" title="Permalink"></a></h3><p>In the previous case, we used the built-ins of the search procedure. However, we can also give a custom enumerator to the search procedure and define a few more values.</p><p>We first define a new problem to test with, we are looking for the programs that can compute the value<code>167</code>. We immediately pass the examples to the problem and then set up the new search.</p><p>Search is done by passing the grammar, the problem and the starting point like before. We now also specify the enumeration function to be used, and now we use depth-first search. Then, we give the maximum depth of the programs we want to search for <code>(3)</code>, the maximum number of nodes in the Abstract Syntax Tree that exists during search <code>(10)</code>, and the maximum time in seconds allowed for the search.</p><pre><code class="language-julia hljs">problem = Herb.HerbData.Problem([Herb.HerbData.IOExample(Dict(:x =&gt; x), 168) for x ∈ 1:5], &quot;example2&quot;)
expr = Herb.HerbSearch.search(g, problem, :Real, enumerator=Herb.HerbSearch.get_dfs_enumerator, max_depth=4, max_size=30, max_time=180)
print(expr)</code></pre><pre><code class="nohighlight hljs">nothing</code></pre><p>We see that our synthesizer can find a program to construct the value <code>168</code>, though a fun experiment would be trying to get the value <code>167</code>, what do you think would happen? If you want you can try below.</p><p>In any case, this concludes our first introduction to the <code>Herb.jl</code> program synthesis framework. You can see more examples in this repository, or explore yourself. Enjoy!</p><pre><code class="language-julia hljs">problem = Herb.HerbData.Problem([Herb.HerbData.IOExample(Dict(:x =&gt; x), 167) for x ∈ 1:5], &quot;example2&quot;)
expr = Herb.HerbSearch.search(g, problem, :Real)
println(expr)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../concepts/">« Architecture and core concepts</a><a class="docs-footer-nextpage" href="../defining_grammars/">Defining Grammars in Herb.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 1 November 2023 17:01">Wednesday 1 November 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
